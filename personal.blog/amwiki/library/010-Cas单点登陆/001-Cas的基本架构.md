## 架构
先用一张图来表达下：

![](assets/010/20180829-30f71a0a.png)  

### 系统组件
CAS服务器和客户端是CAS系统体系结构的两个物理组件，它们通过各种协议进行通信。

### CAS服务器
CAS服务器是基于Spring Framework构建的Java servlet，其主要职责是通过颁发和验证票证来对用户进行身份验证并
授予对启用CAS的服务（通常称为CAS客户端）的访问权限。当服务器在成功登录后向用户发出票证（TGT）时，将
创建SSO会话。使用TGT作为令牌，通过浏览器重定向，根据用户的请求向服务发出服务票据（ST）。随后通过反向信道通信
在CAS服务器上验证ST。这些相互作用在CAS协议文档中有详细描述。

### CAS客户端
术语“CAS客户端”在其共同使用中具有两个不同的含义。CAS客户端是任何启用CAS的应用程序，可以通过支持的协议与服务器
通信。CAS客户端也是可以与各种软件平台和应用程序集成的软件包，以便通过某种认证协议（例如CAS，SAML，OAuth）与CAS服
务器通信。已经开发了支持许多软件平台和产品的CAS客户端，列表如下：

* Apache httpd服务器（mod_auth_cas模块）
* Java（Java CAS客户端）
* .NET（.NET CAS客户端）
* PHP（phpCAS）
* Perl（PerlCAS）
* Python（pycas）
* Ruby（rubycas-client）

在本文中出现术语“CAS客户端”而没有进一步限定时，它指的是集成组件，例如Jasig Java CAS Client，而不是依赖于CAS服
务器（客户端）的应用程序。

### 协议
客户端通过几种支持的协议与服务器通信。所有支持的协议在概念上都是相似的，但有些协议具有使其适用于特定应用程序或
用例的特征。例如，CAS协议支持委托（代理）身份验证，SAML协议支持属性释放和单点注销。
支持的协议如下：
* CAS（版本1,2和3）
* SAML 1.1
* OpenID的
* OAuth（1.0,2.0）

### 软件组件
根据三层子系统描述CAS服务器是有帮助的：
* Web（Spring MVC / Spring Webflow）
* 售票处
* 认证

几乎所有部署的注意事项和组件配置都涉及这三个子系统。Web层是与包括CAS客户端在内的所有外部系统进行通信的端点。
Web层委托票务子系统生成CAS客户端访问的票证。SSO会话开始于成功验证时发出票证，因此票务子系统经常
委托给验证子系统。

认证系统通常仅在SSO会话开始时处理请求，但是在其他情况下可以调用它（例如强制认证）。

### Spring框架
CAS使用Spring Framework的许多方面; 最值得注意的是Spring MVC和 Spring Webflow。Spring为核心CAS代码库
以及部署者提供了一个完整且可扩展的框架; 通过挂钩CAS和Spring API扩展点，可以直接定制或扩展CAS行为。Spring的
一般知识有助于理解某些框架组件之间的相互作用，但并不是严格要求的。但是，用于配置CAS和Spring组件的基于XML的
配置是安装，定制和扩展的核心问题。通常使用XML的能力和 特别是Spring IOC容器是CAS安装的先决条件。
